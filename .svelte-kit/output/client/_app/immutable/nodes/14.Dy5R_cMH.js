import"../chunks/DsnmJJEf.js";import"../chunks/dQoSI2p6.js";import{$ as oe,a7 as ve,a8 as ne,a9 as de,a6 as h,aa as k,ab as M,a2 as u,a3 as ce,f as t,m as D,ad as a,af as n,i as f,ae as e,o as r,ag as o,a1 as K,a0 as tt,al as ue}from"../chunks/BzFeUjkD.js";import{e as Dt,i as _e}from"../chunks/CFC0_nPK.js";import{i as S}from"../chunks/yr0HFLoq.js";import{s as N}from"../chunks/Dx5pcVVY.js";import{t as Ft,s as fe,f as me}from"../chunks/C9WUvhPB.js";import{i as pe}from"../chunks/B4hL2_NH.js";import{a as he,b as ge,c as be,d as we,g as ke,q as xe}from"../chunks/Fm7SvFED.js";var ze=h('<div class="stats-container svelte-1ti3toe"><div class="stat-card svelte-1ti3toe"><div class="stat-value svelte-1ti3toe"> </div> <div class="stat-label svelte-1ti3toe"> </div></div> <div class="stat-card svelte-1ti3toe"><div class="stat-value svelte-1ti3toe"> </div> <div class="stat-label svelte-1ti3toe"> </div></div> <div class="stat-card svelte-1ti3toe"><div class="stat-value svelte-1ti3toe"> </div> <div class="stat-label svelte-1ti3toe"> </div></div></div>'),Ee=h('<span class="badge-finalized svelte-1ti3toe">âœ…</span>'),ye=h('<button><div class="dropdown-item-content svelte-1ti3toe"><div class="dropdown-item-name svelte-1ti3toe"> </div> <div class="dropdown-item-meta svelte-1ti3toe"> </div></div> <!></button>'),Qe=h('<div class="dropdown-menu svelte-1ti3toe"><div class="dropdown-inner svelte-1ti3toe"></div></div>'),qe=h('<div class="config-selector-wrapper svelte-1ti3toe"><div class="config-selector-container svelte-1ti3toe"><button><span class="config-name svelte-1ti3toe"> </span> <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"></polyline></svg></button> <!></div></div>'),Re=h('<div class="action-buttons svelte-1ti3toe"><button class="action-btn calculate svelte-1ti3toe"> </button> <button> </button></div> <div class="filter-toggle svelte-1ti3toe"><button> </button> <button> </button></div>',1),Le=h('<div class="empty-state svelte-1ti3toe"> </div>'),Ce=h('<div class="empty-state error svelte-1ti3toe"> </div>'),Se=h('<div class="empty-state svelte-1ti3toe"> </div>'),$e=h('<div class="empty-state svelte-1ti3toe"> </div>'),Ae=h('<span class="rank-badge svelte-1ti3toe"> </span>'),De=h('<span class="reward-badge svelte-1ti3toe"> </span>'),Fe=h('<span class="status-qualified svelte-1ti3toe"> </span>'),Ne=h('<span class="status-not svelte-1ti3toe"> </span>'),Ue=h('<tr><td class="rank svelte-1ti3toe"><!></td><td class="svelte-1ti3toe"><div class="user-info svelte-1ti3toe"><div class="user-name svelte-1ti3toe"> </div> <div class="user-email svelte-1ti3toe"> </div></div></td><td class="completions svelte-1ti3toe"> </td><td class="svelte-1ti3toe"><!></td></tr>'),Me=h('<div class="table-scroll svelte-1ti3toe"><table class="entries-table svelte-1ti3toe"><thead class="svelte-1ti3toe"><tr><th style="width: 60px;" class="svelte-1ti3toe"> </th><th class="svelte-1ti3toe"> </th><th style="width: 80px;" class="svelte-1ti3toe"> </th><th class="svelte-1ti3toe"> </th></tr></thead><tbody class="svelte-1ti3toe"></tbody></table></div>'),Te=h('<div class="app-screen svelte-1ti3toe"><div class="glass-header svelte-1ti3toe"><a href="/organizer" class="back-btn svelte-1ti3toe" aria-label="Back"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M19 12H5M12 19l-7-7 7-7"></path></svg></a> <h1 class="page-title svelte-1ti3toe"> </h1> <div class="lang-toggle svelte-1ti3toe"><button>TH</button> <span class="sep svelte-1ti3toe">|</span> <button>EN</button></div></div> <div class="scroll-container svelte-1ti3toe"><div class="content-wrapper svelte-1ti3toe"><!> <!> <!> <div class="table-card svelte-1ti3toe"><!></div></div></div></div>');function Ve(Nt,Ut){oe(Ut,!1);const V=D();let et=D(!0),W=D(null),X=D([]),v=D(null),Y=D([]),Mt=null,O=D(!1),U=D(!1),x=D(!1),i=D("th");const l={th:{title:"à¸ˆà¸±à¸”à¸à¸²à¸£ Leaderboard",loading:"à¸à¸³à¸¥à¸±à¸‡à¹‚à¸«à¸¥à¸”à¸‚à¹‰à¸­à¸¡à¸¹à¸¥...",noData:"à¹„à¸¡à¹ˆà¸žà¸šà¸‚à¹‰à¸­à¸¡à¸¹à¸¥ Leaderboard",selectEvent:"à¹€à¸¥à¸·à¸­à¸à¸à¸´à¸ˆà¸à¸£à¸£à¸¡",totalQualified:"à¸œà¸¹à¹‰à¸œà¹ˆà¸²à¸™à¸„à¸¸à¸“à¸ªà¸¡à¸šà¸±à¸•à¸´",totalRewarded:"à¹„à¸”à¹‰à¸£à¸±à¸šà¸£à¸²à¸‡à¸§à¸±à¸¥à¹à¸¥à¹‰à¸§",totalSlots:"à¸£à¸²à¸‡à¸§à¸±à¸¥à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”",calculate:"à¸„à¸³à¸™à¸§à¸“à¸­à¸±à¸™à¸”à¸±à¸š",finalize:"à¸¢à¸·à¸™à¸¢à¸±à¸™à¸œà¸¥",finalized:"à¸¢à¸·à¸™à¸¢à¸±à¸™à¹à¸¥à¹‰à¸§",showAll:"à¹à¸ªà¸”à¸‡à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”",showQualified:"à¹€à¸‰à¸žà¸²à¸°à¸œà¸¹à¹‰à¸œà¹ˆà¸²à¸™",rank:"à¸­à¸±à¸™à¸”à¸±à¸š",name:"à¸Šà¸·à¹ˆà¸­",email:"à¸­à¸µà¹€à¸¡à¸¥",times:"à¸„à¸£à¸±à¹‰à¸‡",qualified:"à¸œà¹ˆà¸²à¸™à¹à¸¥à¹‰à¸§",reward:"à¸£à¸²à¸‡à¸§à¸±à¸¥",notQualified:"à¸¢à¸±à¸‡à¹„à¸¡à¹ˆà¸œà¹ˆà¸²à¸™",noRank:"-",calculating:"à¸à¸³à¸¥à¸±à¸‡à¸„à¸³à¸™à¸§à¸“...",finalizing:"à¸à¸³à¸¥à¸±à¸‡à¸¢à¸·à¸™à¸¢à¸±à¸™...",confirmFinalize:"à¸„à¸¸à¸“à¹à¸™à¹ˆà¹ƒà¸ˆà¸«à¸£à¸·à¸­à¹„à¸¡à¹ˆ? à¸à¸²à¸£à¸¢à¸·à¸™à¸¢à¸±à¸™à¸œà¸¥à¹„à¸¡à¹ˆà¸ªà¸²à¸¡à¸²à¸£à¸–à¸¢à¹‰à¸­à¸™à¸à¸¥à¸±à¸šà¹„à¸”à¹‰!",success:"à¸ªà¸³à¹€à¸£à¹‡à¸ˆ!",error:"à¹€à¸à¸´à¸”à¸‚à¹‰à¸­à¸œà¸´à¸”à¸žà¸¥à¸²à¸”",noEntries:"à¸¢à¸±à¸‡à¹„à¸¡à¹ˆà¸¡à¸µà¸œà¸¹à¹‰à¹€à¸‚à¹‰à¸²à¸£à¹ˆà¸§à¸¡",noQualified:"à¸¢à¸±à¸‡à¹„à¸¡à¹ˆà¸¡à¸µà¸œà¸¹à¹‰à¸œà¹ˆà¸²à¸™à¸„à¸¸à¸“à¸ªà¸¡à¸šà¸±à¸•à¸´"},en:{title:"Manage Leaderboard",loading:"Loading data...",noData:"No Leaderboard Data",selectEvent:"Select Event",totalQualified:"Qualified",totalRewarded:"Rewarded",totalSlots:"Total Slots",calculate:"Calculate Ranks",finalize:"Finalize",finalized:"Finalized",showAll:"Show All",showQualified:"Qualified Only",rank:"Rank",name:"Name",email:"Email",times:"Times",qualified:"Qualified",reward:"Reward",notQualified:"Not Qualified",noRank:"-",calculating:"Calculating...",finalizing:"Finalizing...",confirmFinalize:"Are you sure? This action cannot be undone!",success:"Success!",error:"Error occurred",noEntries:"No participants yet",noQualified:"No qualified participants"}};async function pt(){f(et,!0),f(W,null);try{const s=await he();f(X,s),s.length>0&&await at(s[0])}catch(s){console.error("Error loading configs:",s),f(W,s instanceof Error?s.message:"Unknown error")}finally{f(et,!1)}}async function at(s){f(v,s),f(O,!1);try{const[d,g]=await Promise.all([ge(s.id,!1,0,1e3),be(s.event_id).catch(()=>null)]);f(Y,d.sort((c,z)=>c.rank&&z.rank?c.rank-z.rank:c.rank?-1:z.rank?1:(z.total_completions||0)-(c.total_completions||0))),Mt=g}catch(d){console.error("Error loading config data:",d),alert(`${l[t(i)].error}: ${d instanceof Error?d.message:"Unknown"}`)}}async function Tt(){if(!(!t(v)||t(x))){f(x,!0);try{const s=await we(t(v).id);s.ranked_count===0?alert(l[t(i)].noQualified):(alert(`${l[t(i)].success} à¸ˆà¸±à¸”à¸­à¸±à¸™à¸”à¸±à¸šà¹„à¸”à¹‰ ${s.ranked_count} à¸„à¸™`),await at(t(v)))}catch(s){alert(`${l[t(i)].error}: ${s instanceof Error?s.message:"Unknown"}`)}finally{f(x,!1)}}}async function Bt(){if(!(!t(v)||t(x))&&confirm(l[t(i)].confirmFinalize)){f(x,!0);try{const s=await ke(t(v).id);alert(`${l[t(i)].success} à¹„à¸”à¹‰à¸£à¸±à¸šà¸£à¸²à¸‡à¸§à¸±à¸¥ ${s.total_rewarded} à¸„à¸™`),await pt()}catch(s){alert(`${l[t(i)].error}: ${s instanceof Error?s.message:"Unknown"}`)}finally{f(x,!1)}}}function ht(s){f(i,s)}ve(()=>{const s=localStorage.getItem("lang");(s==="th"||s==="en")&&f(i,s),pt()}),ne(()=>(t(U),t(Y)),()=>{f(V,t(U)?t(Y):t(Y).filter(s=>s.qualified_at))}),de(),pe();var it=Te(),st=a(it),rt=n(a(st),2),Ot=a(rt,!0);e(rt);var gt=n(rt,2),lt=a(gt);let bt;var wt=n(lt,4);let kt;e(gt),e(st);var xt=n(st,2),zt=a(xt),Et=a(zt);{var Ht=s=>{var d=ze(),g=a(d),c=a(g),z=a(c,!0);e(c);var m=n(c,2),L=a(m,!0);e(m),e(g);var C=n(g,2),E=a(C),A=a(E,!0);e(E);var b=n(E,2),w=a(b,!0);e(b),e(C);var $=n(C,2),_=a($),F=a(_,!0);e(_);var y=n(_,2),Q=a(y,!0);e(y),e($),e(d),k(()=>{o(z,(t(v),r(()=>t(v).total_qualified))),o(L,(t(i),r(()=>l[t(i)].totalQualified))),o(A,(t(v),r(()=>t(v).total_rewarded))),o(w,(t(i),r(()=>l[t(i)].totalRewarded))),o(F,(t(v),r(()=>t(v).total_reward_slots))),o(Q,(t(i),r(()=>l[t(i)].totalSlots)))}),u(s,d)};S(Et,s=>{t(v)&&s(Ht)})}var yt=n(Et,2);{var Pt=s=>{var d=qe(),g=a(d),c=a(g),z=a(c),m=a(z,!0);e(z);var L=n(z,2);e(c);var C=n(c,2);{var E=A=>{var b=Qe(),w=a(b);Dt(w,5,()=>t(X),_e,($,_)=>{var F=ye(),y=a(F),Q=a(y),H=a(Q,!0);e(Q);var P=n(Q,2),Z=a(P);e(P),e(y);var I=n(y,2);{var ot=T=>{var vt=Ee();u(T,vt)};S(I,T=>{t(_),r(()=>t(_).is_finalized)&&T(ot)})}e(F),k(()=>{N(F,1,`dropdown-item ${t(_),t(v),r(()=>t(_).id===t(v)?.id?"active":"")??""}`,"svelte-1ti3toe"),o(H,(t(_),r(()=>t(_).name))),o(Z,`${t(_),r(()=>t(_).total_qualified)??""}/${t(_),r(()=>t(_).max_reward_recipients)??""}`)}),M("click",F,()=>at(t(_))),u($,F)}),e(w),e(b),Ft(3,b,()=>fe,()=>({duration:300,easing:xe,axis:"y"})),u(A,b)};S(C,A=>{t(O)&&A(E)})}e(g),e(d),k(()=>{N(c,1,`config-btn ${t(O)?"open":""}`,"svelte-1ti3toe"),o(m,(t(v),t(i),r(()=>t(v)?.name||l[t(i)].selectEvent))),N(L,0,`arrow-icon ${t(O)?"rotate":""}`,"svelte-1ti3toe")}),M("click",c,()=>f(O,!t(O))),u(s,d)};S(yt,s=>{t(X),r(()=>t(X).length>0)&&s(Pt)})}var Qt=n(yt,2);{var jt=s=>{var d=Re(),g=K(d),c=a(g),z=a(c,!0);e(c);var m=n(c,2),L=a(m,!0);e(m),e(g);var C=n(g,2),E=a(C);let A;var b=a(E,!0);e(E);var w=n(E,2);let $;var _=a(w,!0);e(w),e(C),k(()=>{c.disabled=(t(v),t(x),r(()=>t(v).is_finalized||t(x))),o(z,(t(x),t(i),r(()=>t(x)?l[t(i)].calculating:`ðŸ”„ ${l[t(i)].calculate}`))),N(m,1,`action-btn finalize ${t(v),r(()=>t(v).is_finalized?"finalized":"")??""}`,"svelte-1ti3toe"),m.disabled=(t(v),t(x),r(()=>t(v).is_finalized||t(x))),o(L,(t(v),t(i),t(x),r(()=>t(v).is_finalized?`âœ… ${l[t(i)].finalized}`:t(x)?l[t(i)].finalizing:`ðŸ ${l[t(i)].finalize}`))),A=N(E,1,"svelte-1ti3toe",null,A,{active:!t(U)}),o(b,(t(i),r(()=>l[t(i)].showQualified))),$=N(w,1,"svelte-1ti3toe",null,$,{active:t(U)}),o(_,(t(i),r(()=>l[t(i)].showAll)))}),M("click",c,Tt),M("click",m,Bt),M("click",E,()=>f(U,!1)),M("click",w,()=>f(U,!0)),u(s,d)};S(Qt,s=>{t(v)&&s(jt)})}var qt=n(Qt,2),It=a(qt);{var Gt=s=>{var d=Le(),g=a(d,!0);e(d),k(()=>o(g,(t(i),r(()=>l[t(i)].loading)))),u(s,d)},Jt=s=>{var d=tt(),g=K(d);{var c=m=>{var L=Ce(),C=a(L,!0);e(L),k(()=>o(C,t(W))),u(m,L)},z=m=>{var L=tt(),C=K(L);{var E=b=>{var w=Se(),$=a(w,!0);e(w),k(()=>o($,(t(i),r(()=>l[t(i)].noData)))),u(b,w)},A=b=>{var w=tt(),$=K(w);{var _=y=>{var Q=$e(),H=a(Q,!0);e(Q),k(()=>o(H,(t(U),t(i),r(()=>t(U)?l[t(i)].noEntries:l[t(i)].noQualified)))),u(y,Q)},F=y=>{var Q=Me(),H=a(Q),P=a(H),Z=a(P),I=a(Z),ot=a(I,!0);e(I);var T=n(I),vt=a(T,!0);e(T);var nt=n(T),Kt=a(nt,!0);e(nt);var Rt=n(nt),Vt=a(Rt,!0);e(Rt),e(Z),e(P);var Lt=n(P);Dt(Lt,5,()=>t(V),dt=>dt.id,(dt,p)=>{var G=Ue();let Ct;var ct=a(G),Wt=a(ct);{var Xt=q=>{var R=Ae(),J=a(R);e(R),k(()=>o(J,`#${t(p),r(()=>t(p).rank)??""}`)),u(q,R)},Yt=q=>{var R=ue();k(()=>o(R,(t(i),r(()=>l[t(i)].noRank)))),u(q,R)};S(Wt,q=>{t(p),r(()=>t(p).rank)?q(Xt):q(Yt,!1)})}e(ct);var ut=n(ct),St=a(ut),_t=a(St),Zt=a(_t,!0);e(_t);var $t=n(_t,2),te=a($t,!0);e($t),e(St),e(ut);var ft=n(ut),ee=a(ft,!0);e(ft);var At=n(ft),ae=a(At);{var ie=q=>{var R=De(),J=a(R);e(R),k(()=>o(J,`ðŸŽ ${t(p),r(()=>t(p).reward_name)??""}`)),u(q,R)},se=q=>{var R=tt(),J=K(R);{var re=j=>{var B=Fe(),mt=a(B,!0);e(B),k(()=>o(mt,(t(i),r(()=>l[t(i)].qualified)))),u(j,B)},le=j=>{var B=Ne(),mt=a(B,!0);e(B),k(()=>o(mt,(t(i),r(()=>l[t(i)].notQualified)))),u(j,B)};S(J,j=>{t(p),r(()=>t(p).qualified_at)?j(re):j(le,!1)},!0)}u(q,R)};S(ae,q=>{t(p),r(()=>t(p).reward_name)?q(ie):q(se,!1)})}e(At),e(G),k(()=>{Ct=N(G,1,"svelte-1ti3toe",null,Ct,{qualified:t(p).qualified_at}),o(Zt,(t(p),r(()=>t(p).user_full_name||"Anonymous"))),o(te,(t(p),r(()=>t(p).user_email||"-"))),o(ee,(t(p),r(()=>t(p).total_completions)))}),Ft(3,G,()=>me,()=>({duration:200})),u(dt,G)}),e(Lt),e(H),e(Q),k(()=>{o(ot,(t(i),r(()=>l[t(i)].rank))),o(vt,(t(i),r(()=>l[t(i)].name))),o(Kt,(t(i),r(()=>l[t(i)].times))),o(Vt,(t(i),r(()=>l[t(i)].reward)))}),u(y,Q)};S($,y=>{t(V),r(()=>t(V).length===0)?y(_):y(F,!1)},!0)}u(b,w)};S(C,b=>{t(v)?b(A,!1):b(E)},!0)}u(m,L)};S(g,m=>{t(W)?m(c):m(z,!1)},!0)}u(s,d)};S(It,s=>{t(et)?s(Gt):s(Jt,!1)})}e(qt),e(zt),e(xt),e(it),k(()=>{o(Ot,(t(i),r(()=>l[t(i)].title))),bt=N(lt,1,"svelte-1ti3toe",null,bt,{active:t(i)==="th"}),kt=N(wt,1,"svelte-1ti3toe",null,kt,{active:t(i)==="en"})}),M("click",lt,()=>ht("th")),M("click",wt,()=>ht("en")),u(Nt,it),ce()}export{Ve as component};
