import"../chunks/DsnmJJEf.js";import"../chunks/dQoSI2p6.js";import{$ as pe,a7 as me,aj as fe,a8 as ue,a9 as ge,a6 as P,aa as $,ab as C,a2 as b,a3 as _e,ad as a,i,m as p,ae as s,af as o,f as t,a1 as J,ak as N,o as he,ag as j,al as V}from"../chunks/BzFeUjkD.js";import{i as L}from"../chunks/yr0HFLoq.js";import{r as be,b as ye}from"../chunks/DMKKEYkG.js";import{s as Y}from"../chunks/Dx5pcVVY.js";import{t as k,s as O,a as we}from"../chunks/C9WUvhPB.js";import{i as ke}from"../chunks/B4hL2_NH.js";import{a as xe,s as Ee}from"../chunks/Bgcq_F7-.js";import{g as q}from"../chunks/8b7-bA6A.js";import{p as Se}from"../chunks/CSU9-5P9.js";var Te=P("<div><span> </span></div>"),$e=P('<div class="title-section svelte-c68gvn"><h1 class="main-title svelte-c68gvn"> </h1> <p class="sub-title svelte-c68gvn">Enter your email to receive a reset link.</p></div> <div class="form-section svelte-c68gvn"><div class="form-group svelte-c68gvn"><label class="label svelte-c68gvn" for="email">Email</label> <div><input id="email" type="email" placeholder="Enter your email" class="svelte-c68gvn"/></div></div> <!> <button class="primary-btn svelte-c68gvn"><!></button></div>',1),Ce=P(`<div class="icon-wrapper svelte-c68gvn"><div class="success-circle svelte-c68gvn"><svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22,6 12,13 2,6"></polyline></svg></div></div> <div class="title-section svelte-c68gvn" style="text-align:center;"><h1 class="main-title svelte-c68gvn">CHECK YOUR EMAIL</h1> <p class="sub-title svelte-c68gvn">We sent a link to <span style="color:#10b981; font-weight:600;"> </span>.<br/> Please check your inbox.</p> <p class="footer-text svelte-c68gvn" style="font-size: 13px; opacity: 0.7;">(This page will redirect automatically once reset is complete)</p></div> <div class="footer-text svelte-c68gvn">Didn't receive it? <button class="resend-link svelte-c68gvn">Resend</button></div>`,1),Oe=P('<div class="app-screen svelte-c68gvn"><div class="glass-header svelte-c68gvn"><button class="back-btn svelte-c68gvn" aria-label="Back"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></svg></button></div> <div class="scroll-container svelte-c68gvn"><div class="content-wrapper svelte-c68gvn"><div class="form-card svelte-c68gvn"><!></div></div></div></div>');function Ge(Q,X){pe(X,!1);const M=()=>Ee(Se,"$page",Z),[Z,ee]=xe(),te="http://158.108.102.14:8001";let m=p(""),f=p(!1),A=p(1),u=p(""),R=p("error"),c,x=p(""),y=p("/auth/login");function B(e){e.key==="password_reset_done"&&(localStorage.removeItem("password_reset_done"),q(t(y)))}me(()=>{typeof window<"u"&&window.addEventListener("storage",B)}),fe(()=>{typeof window<"u"&&window.removeEventListener("storage",B),c&&clearTimeout(c)});function E(e,n="error",l=""){c&&clearTimeout(c),i(u,e),i(R,n),i(x,l),c=setTimeout(()=>{i(u,""),i(x,"")},4e3)}function F(){t(u)&&(i(u,""),i(x,""),c&&clearTimeout(c))}function ae(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}async function se(){if(F(),!t(m))return E("Please enter your email.","error","email");if(!ae(t(m)))return E("Invalid email format.","error","email");i(f,!0);try{const e=await fetch(`${te}/api/users/forgot-password`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:t(m)})});if(e.ok)i(A,2);else{const n=await e.json().catch(()=>({}));E(n.detail||"Failed to send email.","error")}}catch{E("Cannot connect to server.","error")}finally{i(f,!1)}}ue(()=>M(),()=>{const e=M().url.searchParams.get("return_to");e&&i(y,e)}),ge(),ke();var D=Oe(),I=a(D),G=a(I);s(I);var H=o(I,2),W=a(H),z=a(W),re=a(z);{var ie=e=>{var n=$e(),l=J(n),d=a(l),S=a(d,!0);s(d),N(2),s(l);var g=o(l,2),w=a(g),_=o(a(w),2),h=a(_);be(h),s(_),s(w);var K=o(w,2);{var ne=r=>{var v=Te(),U=a(v),de=a(U,!0);s(U),s(v),$(()=>{Y(v,1,`message-container ${t(R)??""}`,"svelte-c68gvn"),j(de,t(u))}),k(3,v,()=>O,()=>({duration:200})),b(r,v)};L(K,r=>{t(u)&&r(ne)})}var T=o(K,2),le=a(T);{var ve=r=>{var v=V("SENDING...");b(r,v)},ce=r=>{var v=V("SEND LINK");b(r,v)};L(le,r=>{t(f)?r(ve):r(ce,!1)})}s(T),s(g),$(r=>{j(S,r),Y(_,1,`input-field ${t(x)==="email"?"error-border":""}`,"svelte-c68gvn"),h.disabled=t(f),T.disabled=t(f)},[()=>(t(y),he(()=>t(y).includes("login")?"FORGOT PASSWORD":"CHANGE PASSWORD"))]),k(1,l,()=>O),ye(h,()=>t(m),r=>i(m,r)),C("input",h,F),C("click",T,se),k(1,g,()=>O),b(e,n)},oe=e=>{var n=Ce(),l=J(n),d=o(l,2),S=o(a(d),2),g=o(a(S)),w=a(g,!0);s(g),N(3),s(S),N(2),s(d);var _=o(d,2),h=o(a(_));s(_),$(()=>j(w,t(m))),k(1,l,()=>we),k(1,d,()=>O),C("click",h,()=>{i(A,1)}),b(e,n)};L(re,e=>{t(A)===1?e(ie):e(oe,!1)})}s(z),s(W),s(H),s(D),$(()=>G.disabled=t(f)),C("click",G,()=>q(t(y))),b(Q,D),_e(),ee()}export{Ge as component};
