import"../chunks/DsnmJJEf.js";import"../chunks/dQoSI2p6.js";import{$ as zt,a7 as Gt,a8 as Be,a9 as qt,a6 as p,ab as k,aa as $,a2 as m,a3 as Jt,f as e,m as d,aq as Kt,i,an as O,ad as s,ae as a,af as o,ak as ot,o as E,ag as A,a1 as Qt,am as ct}from"../chunks/BzFeUjkD.js";import{e as ce,i as ue}from"../chunks/CFC0_nPK.js";import{i as U}from"../chunks/yr0HFLoq.js";import{s as nt,r as me,c as dt,b as vt}from"../chunks/DMKKEYkG.js";import{s as x}from"../chunks/Dx5pcVVY.js";import{t as M,s as N}from"../chunks/C9WUvhPB.js";import{i as Wt}from"../chunks/B4hL2_NH.js";import{a as Xt,s as Yt}from"../chunks/Bgcq_F7-.js";import{g as Zt}from"../chunks/8b7-bA6A.js";import{p as ea}from"../chunks/CSU9-5P9.js";import{R as Fe}from"../chunks/peVj2t_B.js";var ta=p('<div style="text-align: center; color: #9ca3af; padding: 40px;"><p>Loading...</p></div>'),aa=p('<button type="button" class="option-item svelte-uo0lw"> </button>'),ia=p('<div class="options-list svelte-uo0lw" style="z-index: 101;"></div>'),sa=p('<button type="button" class="option-item svelte-uo0lw"> </button>'),la=p('<div class="options-list svelte-uo0lw"></div>'),ra=p('<button type="button" class="option-item svelte-uo0lw"> </button>'),oa=p('<div class="options-list svelte-uo0lw"></div>'),na=p('<div class="form-group svelte-uo0lw"><label class="label svelte-uo0lw" for="nisitId">Nisit ID</label> <div class="input-field disabled svelte-uo0lw"><input id="nisitId" type="text" disabled class="svelte-uo0lw"/> <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#6b7280" stroke-width="2"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect><path d="M7 11V7a5 5 0 0 1 10 0v4"></path></svg></div></div> <div class="form-group svelte-uo0lw"><label class="label svelte-uo0lw" for="faculty-trigger">Faculty</label> <div class="custom-select-container svelte-uo0lw"><button type="button" id="faculty-trigger"><span> </span> <div><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M6 9l6 6 6-6"></path></svg></div></button> <!></div></div> <div class="form-group svelte-uo0lw"><label class="label svelte-uo0lw" for="major-trigger">Major</label> <div><button type="button" id="major-trigger"><span> </span> <div><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M6 9l6 6 6-6"></path></svg></div></button> <!></div></div>',1),da=p('<button type="button" class="option-item svelte-uo0lw"> </button>'),va=p('<div class="options-list svelte-uo0lw"></div>'),ca=p('<div class="form-group svelte-uo0lw"><label class="label svelte-uo0lw" for="dept-trigger">Department</label> <div class="custom-select-container svelte-uo0lw"><button type="button" id="dept-trigger"><span> </span> <div><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M6 9l6 6 6-6"></path></svg></div></button> <!></div></div>'),ua=ct('<svg style="flex-shrink: 0;" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-uo0lw"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="8" x2="12" y2="12"></line><line x1="12" y1="16" x2="12.01" y2="16"></line></svg>'),ma=ct('<svg style="flex-shrink: 0;" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-uo0lw"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path><polyline points="22 4 12 14.01 9 11.01"></polyline></svg>'),fa=p("<div><!> <span> </span></div>"),pa=p('<div class="form-section svelte-uo0lw"><div class="row-group svelte-uo0lw"><div class="form-group svelte-uo0lw" style="flex: 0 0 90px;"><label class="label svelte-uo0lw" for="title-trigger">Title</label> <div class="custom-select-container svelte-uo0lw"><button type="button" id="title-trigger"><span> </span> <div><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M6 9l6 6 6-6"></path></svg></div></button> <!></div></div> <div class="form-group svelte-uo0lw" style="flex: 1;"><label class="label svelte-uo0lw" for="firstname">First Name</label> <div><input id="firstname" type="text" placeholder="First Name" class="svelte-uo0lw"/></div></div></div> <div class="form-group svelte-uo0lw"><label class="label svelte-uo0lw" for="lastname">Last Name</label> <div><input id="lastname" type="text" placeholder="Last Name" class="svelte-uo0lw"/></div></div> <div class="form-group svelte-uo0lw"><label class="label svelte-uo0lw" for="email">Email</label> <div class="input-field disabled svelte-uo0lw"><input id="email" type="email" disabled class="svelte-uo0lw"/> <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#6b7280" stroke-width="2"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect><path d="M7 11V7a5 5 0 0 1 10 0v4"></path></svg></div></div> <!> <div class="form-group svelte-uo0lw"><div class="password-label-row svelte-uo0lw"><span class="label svelte-uo0lw">Password</span> <a class="text-btn svelte-uo0lw">CHANGE</a></div> <div class="input-field disabled svelte-uo0lw"><input type="password" value="••••••••" disabled class="svelte-uo0lw"/> <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#6b7280" stroke-width="2"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect><path d="M7 11V7a5 5 0 0 1 10 0v4"></path></svg></div></div> <!> <button class="primary-btn svelte-uo0lw" type="button"> </button></div>'),ga=p('<div class="app-screen svelte-uo0lw"><div class="glass-header svelte-uo0lw"><a aria-label="Back" class="back-btn svelte-uo0lw"><svg fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="24"><line x1="19" x2="5" y1="12" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></svg></a></div> <div class="scroll-container svelte-uo0lw"><div class="content-wrapper svelte-uo0lw"><div class="form-card svelte-uo0lw"><div class="title-section svelte-uo0lw"><h1 class="main-title svelte-uo0lw">ACCOUNT SETTINGS</h1> <p class="sub-title svelte-uo0lw">Update your profile information.</p></div> <!></div></div></div></div>');function Ca(ut,mt){zt(mt,!1);const $e=()=>Yt(ea,"$page",ft),[ft,pt]=Xt(),Oe="http://158.108.102.14:8001";let se="",le="",g=d(""),fe=d("/"),L=d(""),R=d(""),H=d(""),Le=d(""),Re=d(""),u=d(""),S=d(""),D=d(""),V=d(!1),z=d(!1),G=d(!1),q=d(!1),pe=d(!0),re=d(!1),T=d({}),He=d(!1),J=d(""),ge=d("error"),Z,we,n=d({title:!1,firstName:!1,lastName:!1,faculty:!1,major:!1,department:!1});const gt=["Mr.","Ms.","Mrs.","Dr.","Prof."],Pe=[{id:"Academic Affairs",name:"Academic Affairs"},{id:"Student Affairs",name:"Student Affairs"},{id:"Registrar Office",name:"Registrar Office"},{id:"Finance Department",name:"Finance Department"},{id:"IT Support Center",name:"IT Support Center"},{id:"Human Resources",name:"Human Resources"}],Ue=[{id:"management",name:"Management Sciences"},{id:"engineering",name:"Engineering at Sriracha"},{id:"science",name:"Science at Sriracha"},{id:"economics",name:"Economics at Sriracha"},{id:"maritime",name:"International Maritime Studies"}],Ve={management:[{id:"mgt",name:"Management"},{id:"fin",name:"Finance and Investment"},{id:"ib",name:"International Business"},{id:"lm",name:"Logistics Management"},{id:"hh",name:"Hospitality - Hotel"},{id:"ht",name:"Hospitality - Tourism"},{id:"acc",name:"Accounting"},{id:"amb",name:"Digital Marketing"}],engineering:[{id:"med",name:"Mechanical Engineering"},{id:"mme",name:"Mechanical & Mfg Systems"},{id:"eee",name:"Electrical & Electronics"},{id:"ise",name:"Industrial Systems"},{id:"cie",name:"Computer Engineering"},{id:"ce",name:"Civil Engineering"},{id:"ee",name:"Electrical Engineering"},{id:"rae",name:"Robotics Engineering"},{id:"die",name:"Digital Electronics"},{id:"dms",name:"Digital Mfg Systems"},{id:"ae",name:"Automotive Engineering"}],science:[{id:"cs",name:"Computer Science"},{id:"it",name:"Information Technology"},{id:"ps",name:"Physics"},{id:"est",name:"Environmental Science"},{id:"dst",name:"Digital Science"},{id:"daa",name:"Data Analytics"},{id:"act",name:"Applied Chemistry"}],economics:[{id:"econ",name:"Economics"}],maritime:[{id:"nao",name:"Naval Architecture"},{id:"ns",name:"Nautical Science"},{id:"mt",name:"Maritime Transportation"},{id:"me",name:"Marine Engineering"}]};let oe=d([]);function wt(t){const l=Ue.find(r=>r.id===t);return l?l.name:"Select Faculty"}function _t(t){const l=e(oe).find(r=>r.id===t);return l?l.name:"Select Major"}function ht(t){const l=Pe.find(r=>r.id===t||r.name===t);return l?l.name:t||"Select Department"}function ze(){i(V,!1),i(z,!1),i(G,!1),i(q,!1)}function ne(t,l){l.stopPropagation();const r=t==="title"&&e(V)||t==="faculty"&&e(z)||t==="major"&&e(G)||t==="dept"&&e(q);ze(),r||(t==="title"&&i(V,!0),t==="faculty"&&i(z,!0),t==="major"&&i(G,!0),t==="dept"&&i(q,!0))}function bt(t){i(L,t),i(V,!1),K()}function yt(t){i(u,t),i(S,""),i(z,!1),K()}function kt(t){i(S,t),i(G,!1),K()}function xt(t){i(D,t),i(q,!1),K()}function de(t,l="error"){Z&&clearTimeout(Z),i(J,t),i(ge,l),Z=setTimeout(()=>{i(J,"")},5e3)}function K(){e(J)&&(i(J,""),Z&&clearTimeout(Z))}function St(){we&&clearTimeout(we),we=setTimeout(()=>{Object.keys(e(n)).forEach(t=>O(n,e(n)[t]=!1))},3e3)}Gt(async()=>{i(pe,!0);try{le=localStorage.getItem("access_token")||"";const t=localStorage.getItem("user_info");if(t)try{const C=JSON.parse(t);se=C.nisit_id||C.id}catch(C){console.error("Error parsing user_info",C)}if(!le||!se)throw new Error("User not authenticated");const l=await fetch(`${Oe}/api/users/${se}`,{method:"GET",headers:{Authorization:`Bearer ${le}`,"Content-Type":"application/json"}});if(!l.ok){if(l.status===401)return Zt("/login");throw new Error("Failed to fetch user data")}const r=await l.json();console.log("Fetched:",r),r.role?i(g,r.role.toLowerCase()):i(g,r.nisit_id||r.nisitId?"student":"officer"),i(L,r.title||""),i(R,r.first_name||r.firstName||""),i(H,r.last_name||r.lastName||""),i(Le,r.email||""),e(g)==="student"?(i(Re,r.nisit_id||r.nisitId||""),i(u,r.faculty||""),setTimeout(()=>{i(S,r.major||"")},50)):i(D,r.department||""),i(T,{title:e(L),firstName:e(R),lastName:e(H),faculty:e(u),major:e(S),department:e(D)}),e(g)==="student"&&setTimeout(()=>{O(T,e(T).major=r.major||"")},50)}catch(t){console.error(t),de("Could not load profile info.","error")}finally{i(pe,!1)}});async function jt(){K();let t=!0;if(Object.keys(e(n)).forEach(l=>O(n,e(n)[l]=!1)),e(L)||(O(n,e(n).title=!0),t=!1),e(R).trim()||(O(n,e(n).firstName=!0),t=!1),e(H).trim()||(O(n,e(n).lastName=!0),t=!1),e(g)==="student"?(e(u)||(O(n,e(n).faculty=!0),t=!1),e(S)||(O(n,e(n).major=!0),t=!1)):e(D)||(O(n,e(n).department=!0),t=!1),!t){St(),e(J)||de("Please fill in all required fields.");return}i(re,!0);try{const l={title:e(L),first_name:e(R),last_name:e(H),major:e(g)==="student"?e(S):null,faculty:e(g)==="student"?e(u):null,department:e(g)==="officer"?e(D):null};console.log("Updating Profile with:",l);const r=await fetch(`${Oe}/api/users/${se}`,{method:"PUT",headers:{Authorization:`Bearer ${le}`,"Content-Type":"application/json"},body:JSON.stringify(l)});if(!r.ok){const C=await r.json();throw new Error(C.message||"Failed to update profile info")}de("Settings updated successfully!","success"),setTimeout(()=>window.location.reload(),1500)}catch(l){console.error(l),de(l.message,"error")}finally{i(re,!1)}}Be(()=>(e(g),Fe),()=>{e(g)==="student"?i(fe,Fe.student.eventList):i(fe,Fe.organizer.createEvent)}),Be(()=>e(u),()=>{e(u)&&Ve[e(u)]?i(oe,Ve[e(u)]):i(oe,[])}),Be(()=>(e(L),e(T),e(R),e(H),e(g),e(u),e(S),e(D)),()=>{const t=e(L)!==e(T).title||e(R)!==e(T).firstName||e(H)!==e(T).lastName;let l=!1;e(g)==="student"?l=e(u)!==e(T).faculty||e(S)!==e(T).major:l=e(D)!==e(T).department,i(He,t||l)}),qt(),Wt();var _e=ga();k("click",Kt,ze);var he=s(_e),Et=s(he);a(he);var Ge=o(he,2),qe=s(Ge),Je=s(qe),Mt=o(s(Je),2);{var Nt=t=>{var l=ta();m(t,l)},Tt=t=>{var l=pa(),r=s(l),C=s(r),Ke=o(s(C),2),ee=s(Ke);let Qe;var be=s(ee),Ct=s(be,!0);a(be);var At=o(be,2);let We;a(ee);var Dt=o(ee,2);{var It=v=>{var c=ia();ce(c,5,()=>gt,ue,(b,w)=>{var y=aa(),_=s(y,!0);a(y),$(()=>A(_,e(w))),k("click",y,()=>bt(e(w))),m(b,y)}),a(c),M(3,c,()=>N,()=>({duration:150})),m(v,c)};U(Dt,v=>{e(V)&&v(It)})}a(Ke),a(C);var Xe=o(C,2),ye=o(s(Xe),2);let Ye;var ke=s(ye);me(ke),a(ye),a(Xe),a(r);var xe=o(r,2),Se=o(s(xe),2);let Ze;var je=s(Se);me(je),a(Se),a(xe);var Ee=o(xe,2),et=o(s(Ee),2),tt=s(et);me(tt),ot(2),a(et),a(Ee);var at=o(Ee,2);{var Bt=v=>{var c=na(),b=Qt(c),w=o(s(b),2),y=s(w);me(y),ot(2),a(w),a(b);var _=o(b,2),X=o(s(_),2),f=s(X);let I;var te=s(f),Te=s(te,!0);a(te);var B=o(te,2);let Q;a(f);var Ce=o(f,2);{var ae=h=>{var j=la();ce(j,5,()=>Ue,ue,(De,W)=>{var F=sa(),Ie=s(F,!0);a(F),$(()=>A(Ie,(e(W),E(()=>e(W).name)))),k("click",F,()=>yt(e(W).id)),m(De,F)}),a(j),M(3,j,()=>N,()=>({duration:150})),m(h,j)};U(Ce,h=>{e(z)&&h(ae)})}a(X),a(_);var P=o(_,2),ie=o(s(P),2);let st;var Y=s(ie);let lt;var Ae=s(Y),Ht=s(Ae,!0);a(Ae);var Pt=o(Ae,2);let rt;a(Y);var Ut=o(Y,2);{var Vt=h=>{var j=oa();ce(j,5,()=>e(oe),ue,(De,W)=>{var F=ra(),Ie=s(F,!0);a(F),$(()=>A(Ie,(e(W),E(()=>e(W).name)))),k("click",F,()=>kt(e(W).id)),m(De,F)}),a(j),M(3,j,()=>N,()=>({duration:150})),m(h,j)};U(Ut,h=>{e(G)&&h(Vt)})}a(ie),a(P),$((h,j)=>{dt(y,e(Re)),I=x(f,1,`select-trigger ${e(n),E(()=>e(n).faculty?"error-border":"")??""}`,"svelte-uo0lw",I,{active:e(z)}),A(Te,h),Q=x(B,1,"arrow-icon svelte-uo0lw",null,Q,{rotate:e(z)}),st=x(ie,1,"custom-select-container svelte-uo0lw",null,st,{disabled:!e(u)}),lt=x(Y,1,`select-trigger ${e(n),E(()=>e(n).major?"error-border":"")??""}`,"svelte-uo0lw",lt,{active:e(G),placeholder:!e(S)}),Y.disabled=!e(u),A(Ht,j),rt=x(Pt,1,"arrow-icon svelte-uo0lw",null,rt,{rotate:e(G)})},[()=>(e(u),E(()=>wt(e(u)))),()=>(e(S),E(()=>_t(e(S))))]),M(3,b,()=>N),k("click",f,h=>ne("faculty",h)),M(3,_,()=>N),k("click",Y,h=>{e(u)&&ne("major",h)}),M(3,P,()=>N),m(v,c)},Ft=v=>{var c=ca(),b=o(s(c),2),w=s(b);let y;var _=s(w),X=s(_,!0);a(_);var f=o(_,2);let I;a(w);var te=o(w,2);{var Te=B=>{var Q=va();ce(Q,5,()=>Pe,ue,(Ce,ae)=>{var P=da(),ie=s(P,!0);a(P),$(()=>A(ie,(e(ae),E(()=>e(ae).name)))),k("click",P,()=>xt(e(ae).id)),m(Ce,P)}),a(Q),M(3,Q,()=>N,()=>({duration:150})),m(B,Q)};U(te,B=>{e(q)&&B(Te)})}a(b),a(c),$(B=>{y=x(w,1,`select-trigger ${e(n),E(()=>e(n).department?"error-border":"")??""}`,"svelte-uo0lw",y,{active:e(q)}),A(X,B),I=x(f,1,"arrow-icon svelte-uo0lw",null,I,{rotate:e(q)})},[()=>(e(D),E(()=>ht(e(D))))]),k("click",w,B=>ne("dept",B)),M(3,c,()=>N),m(v,c)};U(at,v=>{e(g)==="student"?v(Bt):v(Ft,!1)})}var Me=o(at,2),Ne=s(Me),$t=o(s(Ne),2);a(Ne);var Ot=o(Ne,2);a(Me);var it=o(Me,2);{var Lt=v=>{var c=fa(),b=s(c);{var w=f=>{var I=ua();m(f,I)},y=f=>{var I=ma();m(f,I)};U(b,f=>{e(ge)==="error"?f(w):f(y,!1)})}var _=o(b,2),X=s(_,!0);a(_),a(c),$(()=>{x(c,1,`message-container ${e(ge)??""}`,"svelte-uo0lw"),A(X,e(J))}),M(3,c,()=>N,()=>({duration:200})),m(v,c)};U(it,v=>{e(J)&&v(Lt)})}var ve=o(it,2),Rt=s(ve,!0);a(ve),a(l),$(()=>{Qe=x(ee,1,`select-trigger ${e(n),E(()=>e(n).title?"error-border":"")??""}`,"svelte-uo0lw",Qe,{active:e(V)}),A(Ct,e(L)||"Title"),We=x(At,1,"arrow-icon svelte-uo0lw",null,We,{rotate:e(V)}),Ye=x(ye,1,"input-field svelte-uo0lw",null,Ye,{"error-border":e(n).firstName}),Ze=x(Se,1,"input-field svelte-uo0lw",null,Ze,{"error-border":e(n).lastName}),dt(tt,e(Le)),nt($t,"href",`/auth/forgot-password?return_to=${$e(),E(()=>$e().url.pathname)??""}`),ve.disabled=!e(He)||e(re),A(Rt,e(re)?"SAVING...":"SAVE CHANGES")}),k("click",ee,v=>ne("title",v)),vt(ke,()=>e(R),v=>i(R,v)),k("input",ke,K),vt(je,()=>e(H),v=>i(H,v)),k("input",je,K),M(3,Ot,()=>N),k("click",ve,jt),M(3,l,()=>N),m(t,l)};U(Mt,t=>{e(pe)?t(Nt):t(Tt,!1)})}a(Je),a(qe),a(Ge),a(_e),$(()=>nt(Et,"href",e(fe))),m(ut,_e),Jt(),pt()}export{Ca as component};
