import"../chunks/DsnmJJEf.js";import"../chunks/dQoSI2p6.js";import{$ as Z,a7 as ee,a6 as g,a2 as f,a3 as te,i as v,m as M,ao as se,f as p,ad as t,af as s,ae as a,a1 as G,ak as P,aa as W,ag as S,ab as C}from"../chunks/BzFeUjkD.js";import{i as w}from"../chunks/yr0HFLoq.js";import{t as d,a as Y,s as A,f as z}from"../chunks/C9WUvhPB.js";import{i as ae}from"../chunks/B4hL2_NH.js";import{g as E}from"../chunks/8b7-bA6A.js";var ne=g(`<div class="icon-wrapper svelte-tu9pn8"><div class="loader-container svelte-tu9pn8"><div class="loader svelte-tu9pn8"></div> <div class="pulse-ring svelte-tu9pn8"></div></div></div> <div class="title-section svelte-tu9pn8" style="text-align: center;"><h1 class="main-title svelte-tu9pn8">Verifying Your Email</h1> <p class="sub-title svelte-tu9pn8">Hang tight! We're confirming your email address...</p> <div class="loading-dots svelte-tu9pn8"><span class="svelte-tu9pn8"></span><span class="svelte-tu9pn8"></span><span class="svelte-tu9pn8"></span></div></div>`,1),le=g(`<div class="icon-wrapper svelte-tu9pn8"><div class="success-circle svelte-tu9pn8"><svg width="56" height="56" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" class="svelte-tu9pn8"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14" class="svelte-tu9pn8"></path><polyline points="22 4 12 14.01 9 11.01" class="svelte-tu9pn8"></polyline></svg></div></div> <div class="title-section svelte-tu9pn8" style="text-align: center;"><h1 class="main-title svelte-tu9pn8" style="color: #10b981;">All Set! âœ“</h1> <p class="sub-title success-message svelte-tu9pn8"> </p> <p class="sub-title svelte-tu9pn8" style="margin-top: 20px; color: #d1d5db; font-size: 15px;">You're all set to explore KU Run Check-in!</p></div> <div class="form-section svelte-tu9pn8"><div class="countdown-box svelte-tu9pn8"><p class="svelte-tu9pn8">Redirecting to login in <strong class="svelte-tu9pn8"> </strong> seconds...</p></div> <button class="primary-btn svelte-tu9pn8"><span class="btn-icon svelte-tu9pn8"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-tu9pn8"><path d="M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4" class="svelte-tu9pn8"></path><polyline points="10 17 15 12 10 7" class="svelte-tu9pn8"></polyline><line x1="15" y1="12" x2="3" y2="12" class="svelte-tu9pn8"></line></svg></span> GO TO LOGIN</button> <button class="secondary-btn svelte-tu9pn8">BACK TO HOME</button></div>`,1),ie=g('<p class="sub-title svelte-tu9pn8" style="margin-top: 16px; color: #10b981; font-weight: 600;">âœ“ You can proceed to login!</p>'),re=g('<button class="primary-btn svelte-tu9pn8"><span class="btn-icon svelte-tu9pn8"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-tu9pn8"><path d="M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4" class="svelte-tu9pn8"></path><polyline points="10 17 15 12 10 7" class="svelte-tu9pn8"></polyline><line x1="15" y1="12" x2="3" y2="12" class="svelte-tu9pn8"></line></svg></span> GO TO LOGIN</button>'),oe=g('<button class="primary-btn error-btn svelte-tu9pn8"><span class="btn-icon svelte-tu9pn8"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-tu9pn8"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z" class="svelte-tu9pn8"></path><polyline points="9 22 9 12 15 12 15 22" class="svelte-tu9pn8"></polyline></svg></span> BACK TO HOME</button>'),ve=g('<div class="icon-wrapper svelte-tu9pn8"><div class="error-circle svelte-tu9pn8"><svg width="56" height="56" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" class="svelte-tu9pn8"><circle cx="12" cy="12" r="10" class="svelte-tu9pn8"></circle><line x1="12" y1="8" x2="12" y2="12" class="svelte-tu9pn8"></line><line x1="12" y1="16" x2="12.01" y2="16" class="svelte-tu9pn8"></line></svg></div></div> <div class="title-section svelte-tu9pn8" style="text-align: center;"><h1 class="main-title svelte-tu9pn8" style="color: #ef4444;">Verification Issue</h1> <p class="sub-title error-message svelte-tu9pn8"> </p> <!></div> <div class="form-section svelte-tu9pn8"><!> <a href="/auth/register" class="help-link svelte-tu9pn8">Need to register again? Click here</a></div>',1),ce=g('<div class="app-screen svelte-tu9pn8"><div class="scroll-container svelte-tu9pn8"><div class="content-wrapper svelte-tu9pn8"><div class="form-card svelte-tu9pn8"><!> <!> <!></div></div></div></div>');function ye(U,q){Z(q,!1);const D="http://158.108.102.14:8001";let u=M("loading"),o=M("Verifying your email..."),O=M(5),m=null;ee(async()=>{const r=new URLSearchParams(window.location.search).get("token");if(!r){v(u,"error"),v(o,"Oops! We couldn't find a verification token in this link.");return}try{const l=await fetch(`${D}/api/users/verify-email?token=${r}`,{method:"GET",headers:{"Content-Type":"application/json"}}),e=await l.json().catch(()=>({}));if(l.ok){v(u,"success"),v(o,"Your email has been verified successfully! ðŸŽ‰"),localStorage.setItem("register_verified",Date.now().toString());const c=new BroadcastChannel("auth-sync");c.postMessage("register-verified"),c.close(),$()}else v(u,"error"),e.detail?.includes("expired")||e.message?.includes("expired")?v(o,"This verification link has expired. Please request a new one."):e.detail?.includes("already")||e.message?.includes("already")?v(o,"Great news! Your email is already verified. You can log in now."):v(o,e.detail||e.message||"Verification failed. Please try again or contact support.")}catch{v(u,"error"),v(o,"We couldn't connect to the server. Please check your internet connection and try again.")}});function $(){m=setInterval(()=>{se(O,-1),p(O)<=0&&(clearInterval(m),E("/auth/login"))},1e3)}function H(){m&&clearInterval(m),E("/auth/login")}function V(){m&&clearInterval(m),E("/")}ae();var B=ce(),j=t(B),L=t(j),K=t(L),N=t(K);{var F=n=>{var r=ne(),l=G(r),e=s(l,2);d(1,l,()=>Y,()=>({duration:400})),d(1,e,()=>A),f(n,r)};w(N,n=>{p(u)==="loading"&&n(F)})}var R=s(N,2);{var J=n=>{var r=le(),l=G(r),e=s(l,2),c=s(t(e),2),I=t(c,!0);a(c),P(2),a(e);var _=s(e,2),b=t(_),y=t(b),k=s(t(y)),T=t(k,!0);a(k),P(),a(y),a(b);var x=s(b,2),i=s(x,2);a(_),W(()=>{S(I,p(o)),S(T,p(O))}),d(1,l,()=>Y,()=>({duration:500,start:.3})),d(1,e,()=>A,()=>({delay:200})),C("click",x,H),C("click",i,V),d(1,_,()=>z,()=>({delay:400})),f(n,r)};w(R,n=>{p(u)==="success"&&n(J)})}var Q=s(R,2);{var X=n=>{var r=ve(),l=G(r),e=s(l,2),c=s(t(e),2),I=t(c,!0);a(c);var _=s(c,2);{var b=i=>{var h=ie();f(i,h)};w(_,i=>{p(o).includes("already verified")&&i(b)})}a(e);var y=s(e,2),k=t(y);{var T=i=>{var h=re();C("click",h,H),f(i,h)},x=i=>{var h=oe();C("click",h,V),f(i,h)};w(k,i=>{p(o).includes("already verified")?i(T):i(x,!1)})}P(2),a(y),W(()=>S(I,p(o))),d(1,l,()=>Y,()=>({duration:400,start:.5})),d(1,e,()=>A,()=>({delay:200})),d(1,y,()=>z,()=>({delay:400})),f(n,r)};w(Q,n=>{p(u)==="error"&&n(X)})}a(K),a(L),a(j),a(B),f(U,B),te()}export{ye as component};
